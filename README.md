# 딥러닝(DNN)을 활용한 EPL 경기 결과 예측

## 1. 프로젝트 개요

이 프로젝트는 딥러닝 모델을 사용하여 2015-2024 시즌까지의 잉글랜드 프리미어리그(EPL) 경기 데이터를 기반으로 경기 결과를 예측하고, 시즌 최종 순위를 전망하는 과정을 담고 있습니다. 

단순히 높은 예측 성공률을 보이는 모델을 만드는 것을 넘어, 데이터 수집부터 전처리, 모델 설계, 학습, 그리고 **예측 실패 원인 분석**까지 머신러닝 프로젝트의 전체 워크플로우를 경험하고 기록하는 데 중점을 두었습니다. 

## 2. 프로젝트 목표 및 중요성

* **데이터 기반의 스포츠 분석**: 팬들의 경기 몰입도를 높이고 깊이 있는 분석력을 기릅니다. 
* **합리적인 예측**: 베팅 회사의 배당률 함정을 피하고 데이터에 근거한 예측을 시도합니다. 
* **커뮤니티 형성**: 경기 예측과 토론을 통해 팬들 간의 사회적 연결고리를 만듭니다. 

## 3. 사용 데이터

* **데이터 출처**: [football-data.co.uk](https://www.football-data.co.uk/) 
* **데이터 기간**: 2015-16 ~ 2023-24 (총 9개 시즌) 
* **데이터 규모**: 총 3,140 경기 
* **주요 변수 (Features)**: 
    * `HomeTeam`, `AwayTeam`: 홈/원정팀
    * `FTHG`, `FTAG`: 최종 득점
    * `FTR`: 경기 결과 (H/A/D)
    * `HST`, `AST`: 유효 슈팅
    * `HC`, `AC`: 코너킥
    * `HF`, `AF`: 파울
    * `HR`, `AR`: 레드카드 등

## 4. 모델링 및 학습 과정

### 4.1. 데이터 전처리 
1.  **데이터 통합 및 정제**: 여러 시즌의 CSV 파일을 하나의 데이터프레임으로 통합하고, 56개의 초기 컬럼 중 경기 통계와 관련된 23개 핵심 컬럼을 선택했습니다. 
2.  **데이터 타입 변환**: `Date` 컬럼을 `datetime` 객체로 변환했습니다. 
3.  **범주형 데이터 인코딩**: `HomeTeam`과 `AwayTeam`의 문자열 데이터를 고유한 숫자 `code`로 변환했습니다. 
4.  **타겟 변수 생성**: `FTR` (H/A/D) 컬럼을 `HomeWin`, `AwayWin`, `Draw`의 세 가지 이진 변수로 원-핫 인코딩했습니다. 

### 4.2. 모델 1: 경기 통계 기반 결과 예측 DNN 
* **목표**: 경기 세부 통계를 사용하여 승/무/패를 분류합니다. 
* **모델 구조**:
    * 입력층 - `Dense(64, activation='relu')` 
    * `Dropout(0.5)`: 과적합 방지 
    * 은닉층 - `Dense(32, activation='relu')` 
    * `Dropout(0.5)` 
    * 출력층 - `Dense(3, activation='softmax')` 
* **성능**: 16 Epochs 학습 결과, **테스트 정확도(Test Accuracy) 약 61%** 를 달성했습니다. 

### 4.3. 모델 2: 팀 정보 기반 미래 경기 예측 
* **목표**: 경기 통계 없이 오직 팀 코드만으로 미래 경기의 승/무/패 확률을 예측합니다. 
* **입력 (X)**: `HomeTeam code`, `AwayTeam code` 
* **결과**: 23-24 시즌의 남은 280경기를 예측하여 최종 승점을 계산했습니다. 

## 5. 결과 및 실패 원인 분석

모델 2를 이용한 최종 순위 예측 결과, 특정 승점에 결과가 몰리는 등 비현실적인 수치가 도출되어 **예측에 실패**했습니다.  실패 원인은 다음과 같이 분석되었습니다:

1.  **입력 정보의 절대적 부족**: 모델 1과 달리 모델 2는 오직 `HomeTeam code`와 `AwayTeam code` 두 가지만을 입력으로 사용하여 예측에 필요한 정보가 절대적으로 부족했습니다. 
2.  **외부 변수 미반영**: 선수단 라인업, 선수 컨디션, 날씨, 경기 장소 등 실제 경기 결과에 큰 영향을 미치는 다양한 외부 요인들을 데이터에 반영하지 못했습니다.

## 📚 참고 자료

* [프로젝트 발표 자료 (PDF)](./docs/match_prediction.pdf)
